import{r,a as N,f as c,j as s}from"./index-BxsvggaG.js";import{a as b}from"./Skeleton-BiEkAveh.js";function R(){const[n,u]=r.useState([]),[f,i]=r.useState(!0),[l,h]=r.useState("all"),{addToast:t}=N();r.useEffect(()=>{d()},[l]);const d=async()=>{i(!0);try{const e={};l!=="all"&&(e.flagged=l==="flagged");const a=await c.get("/api/v1/admin/reviews",{params:e});u(a.data.reviews||[])}catch{t({type:"error",message:"Failed to load reviews"})}finally{i(!1)}},j=async e=>{if(confirm("Delete this review?"))try{await c.delete(`/api/v1/admin/reviews/${e}`),t({type:"success",message:"Review deleted"}),d()}catch{t({type:"error",message:"Failed to delete review"})}},y=async e=>{try{await c.patch(`/api/v1/admin/reviews/${e}`,{is_flagged:!1}),t({type:"success",message:"Review approved"}),d()}catch{t({type:"error",message:"Failed to approve review"})}},v=e=>"⭐".repeat(e)+"☆".repeat(5-e);return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Reviews"}),s.jsxs("select",{value:l,onChange:e=>h(e.target.value),className:"px-4 py-2 border border-gray-200 rounded-xl",children:[s.jsx("option",{value:"all",children:"All Reviews"}),s.jsx("option",{value:"flagged",children:"Flagged Only"})]})]}),s.jsx("div",{className:"space-y-4",children:f?Array.from({length:3}).map((e,a)=>s.jsx(b,{className:"h-32 rounded-xl"},a)):n.length>0?n.map(e=>{var a,o,x,m,p,g;return s.jsx("div",{className:`card ${e.is_flagged?"border-2 border-red-200 bg-red-50":""}`,children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 overflow-hidden flex items-center justify-center",children:(a=e.user)!=null&&a.profile_photo_url?s.jsx("img",{src:e.user.profile_photo_url,alt:"",className:"w-full h-full object-cover"}):s.jsx("span",{className:"text-xl",children:((x=(o=e.user)==null?void 0:o.first_name)==null?void 0:x[0])||"?"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("div",{children:[s.jsxs("span",{className:"font-medium text-gray-900",children:[(m=e.user)==null?void 0:m.first_name," ",(p=e.user)==null?void 0:p.last_name]}),e.is_flagged&&s.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 bg-red-100 text-red-600 rounded-full",children:"Flagged"})]}),s.jsx("span",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]}),s.jsx("div",{className:"text-yellow-400 text-sm mb-2",children:v(e.rating)}),s.jsx("p",{className:"text-gray-600 mb-3",children:e.comment}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-xs text-gray-400",children:["Product: ",((g=e.product)==null?void 0:g.title)||`#${e.product_id}`]}),s.jsxs("div",{className:"flex gap-2",children:[e.is_flagged&&s.jsx("button",{onClick:()=>y(e.id),className:"text-xs px-3 py-1 bg-green-50 text-green-600 rounded-lg",children:"Approve"}),s.jsx("button",{onClick:()=>j(e.id),className:"text-xs px-3 py-1 bg-red-50 text-red-600 rounded-lg",children:"Delete"})]})]})]})]})},e.id)}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("span",{className:"text-5xl block mb-3",children:"⭐"}),s.jsx("p",{className:"text-gray-500",children:"No reviews found"})]})})]})}export{R as default};
