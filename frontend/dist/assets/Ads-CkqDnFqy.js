import{r as l,a as F,f as n,j as e}from"./index-BxsvggaG.js";import{a as B}from"./Skeleton-BiEkAveh.js";function M(){const[g,y]=l.useState([]),[j,N]=l.useState(!0),[k,c]=l.useState(!1),[r,i]=l.useState({title:"",link_url:"",position:"home_banner",is_active:!0}),[u,x]=l.useState(null),[h,o]=l.useState(""),[p,b]=l.useState(null),{addToast:a}=F();l.useEffect(()=>{d()},[]);const d=async()=>{try{const t=await n.get("/api/v1/admin/ads");y(t.data.ads||[])}catch{a({type:"error",message:"Failed to load ads"})}finally{N(!1)}},w=t=>{const s=t.target.files[0];s&&(x(s),o(URL.createObjectURL(s)))},_=async t=>{t.preventDefault();const s=new FormData;Object.entries(r).forEach(([m,L])=>s.append(m,L)),u&&s.append("image",u);try{if(p)await n.put(`/api/v1/admin/ads/${p.id}`,s,{headers:{"Content-Type":"multipart/form-data"}}),a({type:"success",message:"Ad updated!"});else{if(!u){a({type:"error",message:"Please select an image"});return}await n.post("/api/v1/admin/ads",s,{headers:{"Content-Type":"multipart/form-data"}}),a({type:"success",message:"Ad created!"})}c(!1),v(),d()}catch{a({type:"error",message:"Failed to save ad"})}},C=t=>{b(t),i({title:t.title,link_url:t.link_url||"",position:t.position,is_active:t.is_active}),o(t.image_url),c(!0)},A=async t=>{if(confirm("Delete this ad?"))try{await n.delete(`/api/v1/admin/ads/${t}`),a({type:"success",message:"Ad deleted"}),d()}catch{a({type:"error",message:"Failed to delete ad"})}},S=async t=>{try{await n.patch(`/api/v1/admin/ads/${t.id}`,{is_active:!t.is_active}),a({type:"success",message:t.is_active?"Ad deactivated":"Ad activated"}),d()}catch{a({type:"error",message:"Failed to update ad"})}},v=()=>{i({title:"",link_url:"",position:"home_banner",is_active:!0}),x(null),o(""),b(null)},f=[{value:"home_banner",label:"Home Banner"},{value:"category_banner",label:"Category Banner"},{value:"search_banner",label:"Search Results"},{value:"bottom_banner",label:"Bottom (CTA) Banner"}];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Ad Banners"}),e.jsx("button",{onClick:()=>{v(),c(!0)},className:"btn-primary",children:"+ Create Ad"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j?Array.from({length:3}).map((t,s)=>e.jsx(B,{className:"h-48 rounded-xl"},s)):g.length>0?g.map(t=>{var s;return e.jsxs("div",{className:`card overflow-hidden ${t.is_active?"":"opacity-60"}`,children:[e.jsx("div",{className:"h-32 bg-gray-100 overflow-hidden -mx-4 -mt-4 mb-4",children:t.image_url?e.jsx("img",{src:t.image_url,alt:t.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-4xl",children:"ðŸ“¢"})}),e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:t.title}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:(s=f.find(m=>m.value===t.position))==null?void 0:s.label}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>S(t),className:`text-xs px-3 py-1 rounded-lg flex-1 ${t.is_active?"bg-green-50 text-green-600":"bg-gray-50 text-gray-600"}`,children:t.is_active?"Active":"Inactive"}),e.jsx("button",{onClick:()=>C(t),className:"text-xs px-3 py-1 bg-blue-50 text-blue-600 rounded-lg",children:"Edit"}),e.jsx("button",{onClick:()=>A(t.id),className:"text-xs px-3 py-1 bg-red-50 text-red-600 rounded-lg",children:"Delete"})]})]},t.id)}):e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("span",{className:"text-5xl block mb-3",children:"ðŸ“¢"}),e.jsx("p",{className:"text-gray-500",children:"No ads created yet"})]})}),k&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:p?"Edit Ad":"Create Ad"}),e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:r.title,onChange:t=>i({...r,title:t.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Banner Image *"}),e.jsxs("div",{className:"space-y-3",children:[h&&e.jsxs("div",{className:"relative aspect-video rounded-xl overflow-hidden bg-gray-100 border border-gray-200",children:[e.jsx("img",{src:h,alt:"Preview",className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>{x(null),o("")},className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("label",{className:`
                                        flex flex-col items-center justify-center w-full aspect-video rounded-xl border-2 border-dashed border-gray-300 cursor-pointer hover:border-primary-500 hover:bg-primary-50 transition-all
                                        ${h?"hidden":"flex"}
                                    `,children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx("svg",{className:"w-8 h-8 mb-3 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Click to upload banner"})]}),e.jsx("input",{type:"file",accept:"image/*",onChange:w,className:"hidden"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Link URL"}),e.jsx("input",{type:"url",value:r.link_url,onChange:t=>i({...r,link_url:t.target.value}),className:"input",placeholder:"https://..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Position"}),e.jsx("select",{value:r.position,onChange:t=>i({...r,position:t.target.value}),className:"input",children:f.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"btn-secondary flex-1",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Save"})]})]})]})})]})}export{M as default};
