import{r as n,a as R,f as p,j as e}from"./index-BxsvggaG.js";import{a as $}from"./Skeleton-BiEkAveh.js";const q=[{key:"dashboard",label:"Dashboard",desc:"View admin dashboard overview"},{key:"users",label:"Manage Users",desc:"View and moderate user accounts"},{key:"stores",label:"Manage Stores",desc:"View, verify, and suspend stores"},{key:"store_requests",label:"Store Requests",desc:"Approve or reject seller applications"},{key:"products",label:"Manage Products",desc:"View and moderate products"},{key:"categories",label:"Categories",desc:"Manage product categories"},{key:"orders",label:"Orders",desc:"View and manage orders"},{key:"reports",label:"Reports",desc:"Review and resolve user reports"},{key:"reviews",label:"Reviews",desc:"Moderate product reviews"}],k=({selected:d,onToggle:y})=>e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:q.map(l=>e.jsxs("label",{className:`flex items-start gap-3 p-3 rounded-xl border-2 cursor-pointer transition-all ${d.includes(l.key)?"border-primary-400 bg-primary-50":"border-gray-200 bg-white hover:border-gray-300"}`,children:[e.jsx("input",{type:"checkbox",checked:d.includes(l.key),onChange:()=>y(l.key),className:"w-4 h-4 rounded text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:l.label}),e.jsx("p",{className:"text-xs text-gray-500",children:l.desc})]})]},l.key))});function I(){const[d,y]=n.useState([]),[l,_]=n.useState(!0),[u,f]=n.useState(!1),[j,v]=n.useState(!1),[c,h]=n.useState(null),[g,N]=n.useState([]),[w,S]=n.useState(!1),[i,b]=n.useState({first_name:"",last_name:"",email:"",phone:"",password:"",permissions:["dashboard"]}),{addToast:a}=R();n.useEffect(()=>{m()},[]);const m=async()=>{try{const s=await p.get("/api/v1/admin/support-admins");y(s.data.support_admins||[])}catch{a({type:"error",message:"Failed to fetch support admins"})}finally{_(!1)}},x=s=>{const{name:t,value:r}=s.target;b(o=>({...o,[t]:r}))},C=s=>{b(t=>{const r=t.permissions.includes(s)?t.permissions.filter(o=>o!==s):[...t.permissions,s];return{...t,permissions:r}})},A=s=>{N(t=>t.includes(s)?t.filter(r=>r!==s):[...t,s])},P=async s=>{var t,r;if(s.preventDefault(),i.permissions.length===0){a({type:"error",message:"Select at least one permission"});return}v(!0);try{await p.post("/api/v1/admin/support-admins",i),a({type:"success",message:"Support admin created!"}),f(!1),b({first_name:"",last_name:"",email:"",phone:"",password:"",permissions:["dashboard"]}),m()}catch(o){a({type:"error",message:((r=(t=o.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to create support admin"})}finally{v(!1)}},E=async s=>{try{await p.put(`/api/v1/admin/support-admins/${s.id}`,{permissions:s.permissions||[],is_active:!s.is_active}),a({type:"success",message:s.is_active?"Admin suspended":"Admin activated"}),m()}catch{a({type:"error",message:"Failed to update status"})}},M=async()=>{if(g.length===0){a({type:"error",message:"Select at least one permission"});return}S(!0);try{await p.put(`/api/v1/admin/support-admins/${c.id}`,{permissions:g}),a({type:"success",message:"Permissions updated!"}),h(null),m()}catch{a({type:"error",message:"Failed to update permissions"})}finally{S(!1)}},L=async s=>{if(window.confirm("Remove this support admin? They will be reverted to a regular user."))try{await p.delete(`/api/v1/admin/support-admins/${s}`),a({type:"success",message:"Support admin removed"}),m()}catch{a({type:"error",message:"Failed to remove support admin"})}},F=s=>{h(s),N(s.permissions||[])};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Support Admins"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create moderator accounts with limited admin permissions"})]}),e.jsxs("button",{onClick:()=>f(!u),className:"btn-primary flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:u?"M6 18L18 6M6 6l12 12":"M12 4v16m8-8H4"})}),u?"Cancel":"Add Support Admin"]})]}),u&&e.jsxs("form",{onSubmit:P,className:"card space-y-5 border-2 border-primary-200 bg-primary-50/30",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Create Support Admin"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),e.jsx("input",{type:"text",name:"first_name",value:i.first_name,onChange:x,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),e.jsx("input",{type:"text",name:"last_name",value:i.last_name,onChange:x,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",name:"email",value:i.email,onChange:x,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"text",name:"phone",value:i.phone,onChange:x,className:"input"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),e.jsx("input",{type:"password",name:"password",value:i.password,onChange:x,className:"input",required:!0,minLength:8}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 8 characters"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-3",children:["Assign Permissions ",e.jsxs("span",{className:"text-xs font-normal text-gray-500",children:["(",i.permissions.length," selected)"]})]}),e.jsx(k,{selected:i.permissions,onToggle:C})]}),e.jsx("button",{type:"submit",disabled:j,className:"btn-primary w-full disabled:opacity-50",children:j?"Creating...":"Create Support Admin"})]}),e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-500",children:"Admin"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-500",children:"Email"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-500",children:"Permissions"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-500",children:"Status"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-gray-500",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:l?Array.from({length:3}).map((s,t)=>e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-4",children:e.jsx($,{className:"h-10 w-full"})})},t)):d.length>0?d.map(s=>{var t,r;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-white font-medium ${s.is_active?"bg-gradient-to-br from-purple-400 to-indigo-500":"bg-gray-400"}`,children:[(t=s.first_name)==null?void 0:t[0],(r=s.last_name)==null?void 0:r[0]]}),e.jsxs("span",{className:`font-medium ${s.is_active?"text-gray-900":"text-gray-400"}`,children:[s.first_name," ",s.last_name]})]})}),e.jsx("td",{className:"p-4 text-gray-600",children:s.email}),e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:(s.permissions||[]).map(o=>e.jsx("span",{className:"px-2 py-0.5 bg-indigo-50 text-indigo-600 rounded-md text-[10px] font-semibold uppercase",children:o.replace("_"," ")},o))})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:s.is_active?"Active":"Suspended"})}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>F(s),className:"text-xs px-3 py-1.5 bg-indigo-50 text-indigo-600 hover:bg-indigo-100 rounded-lg font-medium transition-colors",children:"Edit"}),e.jsx("button",{onClick:()=>E(s),className:`text-xs px-3 py-1.5 rounded-lg font-medium transition-colors ${s.is_active?"bg-yellow-50 text-yellow-700 hover:bg-yellow-100":"bg-green-50 text-green-600 hover:bg-green-100"}`,children:s.is_active?"Suspend":"Activate"}),e.jsx("button",{onClick:()=>L(s.id),className:"text-xs px-3 py-1.5 bg-red-50 text-red-600 hover:bg-red-100 rounded-lg font-medium transition-colors",children:"Remove"})]})})]},s.id)}):e.jsx("tr",{children:e.jsxs("td",{colSpan:5,className:"p-12 text-center",children:[e.jsx("div",{className:"text-gray-400 text-4xl mb-3",children:"ðŸ‘¥"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No support admins yet"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:'Click "Add Support Admin" to create one'})]})})})]})}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[100]",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-2xl overflow-hidden animate-scale-up",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Edit Permissions"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:[c.first_name," ",c.last_name," â€” ",c.email]})]}),e.jsx("button",{onClick:()=>h(null),className:"text-gray-400 hover:text-gray-600 p-2",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900",children:["Permissions ",e.jsxs("span",{className:"text-xs font-normal text-gray-500",children:["(",g.length," selected)"]})]}),e.jsx(k,{selected:g,onToggle:A})]}),e.jsxs("div",{className:"p-6 border-t border-gray-100 flex gap-3",children:[e.jsx("button",{onClick:M,disabled:w,className:"flex-1 btn-primary disabled:opacity-50",children:w?"Saving...":"Save Permissions"}),e.jsx("button",{onClick:()=>h(null),className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold hover:bg-gray-200 transition-all",children:"Cancel"})]})]})})]})}export{I as default};
