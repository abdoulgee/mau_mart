import{b as _,a as w,d as k,r as o,j as e,f as C}from"./index-BxsvggaG.js";import{H as S}from"./Header-DUNe79n9.js";function F(){var h;const{user:t,updateUser:f}=_(),{addToast:d}=w(),x=k(),[c,m]=o.useState(!1),[p,g]=o.useState(null),[u,j]=o.useState((t==null?void 0:t.profile_photo_url)||null),[a,b]=o.useState({first_name:(t==null?void 0:t.first_name)||"",last_name:(t==null?void 0:t.last_name)||"",phone:(t==null?void 0:t.phone)||"",student_id:(t==null?void 0:t.student_id)||""}),l=r=>{b(s=>({...s,[r.target.name]:r.target.value}))},v=r=>{const s=r.target.files[0];if(s){g(s);const i=new FileReader;i.onloadend=()=>{j(i.result)},i.readAsDataURL(s)}},y=async r=>{var s,i;r.preventDefault(),m(!0);try{const n=new FormData;n.append("first_name",a.first_name),n.append("last_name",a.last_name),n.append("phone",a.phone),n.append("student_id",a.student_id),p&&n.append("profile_picture",p);const N=await C.put("/api/v1/users/profile",n,{headers:{"Content-Type":"multipart/form-data"}});f(N.data.user),d({type:"success",message:"Profile updated successfully"}),x("/profile")}catch(n){d({type:"error",message:((i=(s=n.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to update profile"})}finally{m(!1)}};return e.jsxs("div",{className:"min-h-screen bg-surface-50 pb-20",children:[e.jsx(S,{title:"Edit Profile",showBack:!0}),e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:y,className:"card space-y-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-surface-200 overflow-hidden flex items-center justify-center ring-4 ring-primary-100",children:u?e.jsx("img",{src:u,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-3xl font-bold text-primary-400",children:((h=t==null?void 0:t.first_name)==null?void 0:h[0])||"?"})}),e.jsx("label",{htmlFor:"profile-picture",className:"absolute bottom-0 right-0 bg-primary-500 text-white rounded-full p-2 cursor-pointer hover:bg-primary-600 transition-colors shadow-md",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})}),e.jsx("input",{id:"profile-picture",type:"file",accept:"image/*",onChange:v,className:"hidden"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Click camera icon to change photo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),e.jsx("input",{type:"text",name:"first_name",value:a.first_name,onChange:l,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),e.jsx("input",{type:"text",name:"last_name",value:a.last_name,onChange:l,className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",value:a.phone,onChange:l,className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),e.jsx("input",{type:"text",name:"student_id",value:a.student_id,onChange:l,className:"input",placeholder:"Enter your student ID"})]}),e.jsx("button",{type:"submit",disabled:c,className:"btn-primary w-full",children:c?"Saving...":"Save Changes"})]})})]})}export{F as default};
