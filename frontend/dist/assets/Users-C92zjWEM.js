import{r as a,a as S,f as v,j as e}from"./index-BxsvggaG.js";import{a as L}from"./Skeleton-BiEkAveh.js";const N={user:"bg-gray-100 text-gray-700",seller:"bg-green-100 text-green-700",admin:"bg-blue-100 text-blue-700",super_admin:"bg-purple-100 text-purple-700"};function E({user:s,onClose:c,onSaved:p}){const[l,x]=a.useState({first_name:"",last_name:"",email:"",phone:"",student_id:""}),[h,d]=a.useState(!1),{addToast:u}=S();if(a.useEffect(()=>{s&&x({first_name:s.first_name||"",last_name:s.last_name||"",email:s.email||"",phone:s.phone||"",student_id:s.student_id||""})},[s]),!s)return null;const r=n=>{x({...l,[n.target.name]:n.target.value})},f=async n=>{var g,i;n.preventDefault(),d(!0);try{await v.put(`/api/v1/admin/users/${s.id}/edit`,l),u({type:"success",message:"User info updated!"}),p()}catch(m){u({type:"error",message:((i=(g=m.response)==null?void 0:g.data)==null?void 0:i.message)||"Failed to update user"})}finally{d(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[100]",onClick:c,children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-lg animate-scale-up",onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between bg-gray-50",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Edit User"}),e.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 p-2",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),e.jsx("input",{type:"text",name:"first_name",value:l.first_name,onChange:r,className:"w-full px-3 py-2 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),e.jsx("input",{type:"text",name:"last_name",value:l.last_name,onChange:r,className:"w-full px-3 py-2 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:l.email,onChange:r,className:"w-full px-3 py-2 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",value:l.phone,onChange:r,className:"w-full px-3 py-2 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),e.jsx("input",{type:"text",name:"student_id",value:l.student_id,onChange:r,className:"w-full px-3 py-2 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"submit",disabled:h,className:"flex-1 py-3 bg-primary-600 text-white rounded-xl font-bold hover:bg-primary-700 disabled:opacity-50 transition-all",children:h?"Saving...":"Save Changes"}),e.jsx("button",{type:"button",onClick:c,className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold hover:bg-gray-200 transition-all",children:"Cancel"})]})]})]})})}function M({user:s,onClose:c}){const[p,l]=a.useState(""),[x,h]=a.useState(""),[d,u]=a.useState(!1),[r,f]=a.useState(!1),{addToast:n}=S();if(!s)return null;const g=async i=>{var m,j;if(i.preventDefault(),p.length<6){n({type:"error",message:"Password must be at least 6 characters"});return}if(p!==x){n({type:"error",message:"Passwords do not match"});return}u(!0);try{await v.post(`/api/v1/admin/users/${s.id}/reset-password`,{new_password:p}),n({type:"success",message:`Password reset for ${s.email}!`}),c()}catch(y){n({type:"error",message:((j=(m=y.response)==null?void 0:m.data)==null?void 0:j.message)||"Failed to reset password"})}finally{u(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[100]",onClick:c,children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md animate-scale-up",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between bg-red-50",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Reset Password"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["For: ",s.email]})]}),e.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 p-2",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:r?"text":"password",value:p,onChange:i=>l(i.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 pr-10",placeholder:"Min 6 characters",required:!0,minLength:6}),e.jsx("button",{type:"button",onClick:()=>f(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:r?"ðŸ™ˆ":"ðŸ‘ï¸"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),e.jsx("input",{type:r?"text":"password",value:x,onChange:i=>h(i.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Repeat the password",required:!0,minLength:6})]}),e.jsx("div",{className:"p-3 bg-yellow-50 rounded-xl border border-yellow-200",children:e.jsxs("p",{className:"text-xs text-yellow-700",children:[e.jsx("strong",{children:"âš ï¸ Warning:"})," This will immediately change the user's password. They will need to use the new password to log in."]})}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"submit",disabled:d,className:"flex-1 py-3 bg-red-600 text-white rounded-xl font-bold hover:bg-red-700 disabled:opacity-50 transition-all",children:d?"Resetting...":"Reset Password"}),e.jsx("button",{type:"button",onClick:c,className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold hover:bg-gray-200 transition-all",children:"Cancel"})]})]})]})})}function $(){const[s,c]=a.useState([]),[p,l]=a.useState(!0),[x,h]=a.useState(""),[d,u]=a.useState(1),[r,f]=a.useState({}),[n,g]=a.useState(null),[i,m]=a.useState(null),[j,y]=a.useState(null),{addToast:w}=S(),P=({user:t,onClose:o})=>{var b,C;return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[100]",onClick:o,children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-lg overflow-hidden animate-scale-up",onClick:U=>U.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between bg-gray-50",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"User Information"}),e.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600 p-2",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-primary-400 to-accent-500 flex items-center justify-center text-white text-3xl font-bold",children:[(b=t.first_name)==null?void 0:b[0],(C=t.last_name)==null?void 0:C[0]]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold text-gray-900",children:[t.first_name," ",t.last_name]}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${N[t.role]||N.user}`,children:t.role}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:t.is_active?"Active":"Suspended"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Email Address"}),e.jsx("p",{className:"text-gray-900 font-medium",children:t.email})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Phone Number"}),e.jsx("p",{className:"text-gray-900 font-medium",children:t.phone||"Not provided"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Student ID"}),e.jsx("p",{className:"text-gray-900 font-medium",children:t.student_id||"Not provided"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Joined Date"}),e.jsx("p",{className:"text-gray-900 font-medium",children:new Date(t.created_at).toLocaleDateString(void 0,{dateStyle:"long"})})]})]}),e.jsxs("div",{className:"pt-4 grid grid-cols-3 gap-3",children:[e.jsx("button",{onClick:()=>{o(),m(t)},className:"py-3 rounded-xl font-bold transition-all bg-primary-50 text-primary-600 hover:bg-primary-100 border border-primary-200",children:"âœï¸ Edit Info"}),e.jsx("button",{onClick:()=>{o(),y(t)},className:"py-3 rounded-xl font-bold transition-all bg-amber-50 text-amber-600 hover:bg-amber-100 border border-amber-200",children:"ðŸ”‘ Reset PW"}),e.jsx("button",{onClick:()=>{_(t.id),o()},className:`py-3 rounded-xl font-bold transition-all ${t.is_active?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-200":"bg-green-50 text-green-600 hover:bg-green-100 border border-green-200"}`,children:t.is_active?"ðŸš« Suspend":"âœ… Activate"})]})]})]})}):null};a.useEffect(()=>{k()},[d,x]);const k=async()=>{l(!0);try{const t=await v.get("/api/v1/admin/users",{params:{page:d,limit:20,search:x}});c(t.data.users||[]),f(t.data.pagination||{})}catch{w({type:"error",message:"Failed to fetch users"})}finally{l(!1)}},_=async t=>{try{await v.post(`/api/v1/admin/users/${t}/toggle-status`),w({type:"success",message:"User status updated"}),k()}catch{w({type:"error",message:"Failed to update user status"})}};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Users"}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("input",{type:"search",value:x,onChange:t=>h(t.target.value),placeholder:"Search users...",className:"px-4 py-2 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500"})})]}),e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-500",children:"User"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-500",children:"Email"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-500",children:"Role"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-500",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-500",children:"Joined"}),e.jsx("th",{className:"text-right p-4 text-sm font-medium text-gray-500",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:p?Array.from({length:5}).map((t,o)=>e.jsx("tr",{children:e.jsx("td",{className:"p-4",colSpan:6,children:e.jsx(L,{className:"h-12 w-full"})})},o)):s.length>0?s.map(t=>{var o,b;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer group",onClick:()=>g(t),children:[e.jsxs("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-400 to-accent-500 flex items-center justify-center text-white font-medium group-hover:scale-110 transition-transform",children:[(o=t.first_name)==null?void 0:o[0],(b=t.last_name)==null?void 0:b[0]]}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900 group-hover:text-primary-600 decoration-primary-500 group-hover:underline",children:[t.first_name," ",t.last_name]}),t.student_id&&e.jsx("p",{className:"text-xs text-gray-500",children:t.student_id})]})]})}),e.jsx("td",{className:"p-4 text-gray-600",children:t.email}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${N[t.role]||N.user}`,children:t.role})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:t.is_active?"Active":"Suspended"})}),e.jsx("td",{className:"p-4 text-gray-500 text-sm",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>m(t),className:"text-sm px-3 py-1 rounded-lg bg-primary-50 text-primary-600 hover:bg-primary-100",title:"Edit user info",children:"âœï¸"}),e.jsx("button",{onClick:()=>y(t),className:"text-sm px-3 py-1 rounded-lg bg-amber-50 text-amber-600 hover:bg-amber-100",title:"Reset password",children:"ðŸ”‘"}),e.jsx("button",{onClick:()=>_(t.id),className:`text-sm px-3 py-1 rounded-lg ${t.is_active?"bg-red-50 text-red-600 hover:bg-red-100":"bg-green-50 text-green-600 hover:bg-green-100"}`,title:t.is_active?"Suspend":"Activate",children:t.is_active?"ðŸš«":"âœ…"})]})})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-8 text-center text-gray-500",children:"No users found"})})})]})})}),r.pages>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>u(t=>Math.max(1,t-1)),disabled:d===1,className:"px-4 py-2 bg-gray-100 rounded-lg disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"text-gray-600",children:["Page ",d," of ",r.pages]}),e.jsx("button",{onClick:()=>u(t=>Math.min(r.pages,t+1)),disabled:d===r.pages,className:"px-4 py-2 bg-gray-100 rounded-lg disabled:opacity-50",children:"Next"})]}),e.jsx(P,{user:n,onClose:()=>g(null)}),e.jsx(E,{user:i,onClose:()=>m(null),onSaved:()=>{m(null),k()}}),e.jsx(M,{user:j,onClose:()=>y(null)})]})}export{$ as default};
