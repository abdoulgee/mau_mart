import{r as l,a as S,f as n,j as e}from"./index-BxsvggaG.js";function k(){const[a,c]=l.useState({mail_server:"",mail_port:587,mail_use_tls:!0,mail_use_ssl:!1,mail_username:"",mail_password:"",mail_default_sender:""}),[g,f]=l.useState(!0),[m,o]=l.useState(!1),[d,u]=l.useState(!1),[r,y]=l.useState(""),{addToast:i}=S();l.useEffect(()=>{b()},[]);const b=async()=>{try{const s=await n.get("/api/v1/admin/smtp-config");s.data.config&&c({...a,...s.data.config})}catch{}finally{f(!1)}},t=s=>{const{name:p,value:x,type:h,checked:N}=s.target;c(_=>({..._,[p]:h==="checkbox"?N:h==="number"?parseInt(x):x}))},j=async s=>{s.preventDefault(),o(!0);try{await n.post("/api/v1/admin/smtp-config",a),i({type:"success",message:"SMTP configuration saved!"})}catch{i({type:"error",message:"Failed to save configuration"})}finally{o(!1)}},v=async()=>{if(!r){i({type:"error",message:"Enter a test email address"});return}u(!0);try{await n.post("/api/v1/admin/smtp-test",{email:r}),i({type:"success",message:"Test email sent! Check your inbox."})}catch{i({type:"error",message:"Failed to send test email. Check your configuration."})}finally{u(!1)}};return g?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"animate-pulse bg-gray-200 h-96 rounded-xl"})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"SMTP Configuration"}),e.jsxs("form",{onSubmit:j,className:"card space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mail Server *"}),e.jsx("input",{type:"text",name:"mail_server",value:a.mail_server,onChange:t,placeholder:"smtp.gmail.com",className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Port *"}),e.jsx("input",{type:"number",name:"mail_port",value:a.mail_port,onChange:t,className:"input",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username *"}),e.jsx("input",{type:"email",name:"mail_username",value:a.mail_username,onChange:t,placeholder:"your@email.com",className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),e.jsx("input",{type:"password",name:"mail_password",value:a.mail_password,onChange:t,placeholder:"App password",className:"input",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Sender"}),e.jsx("input",{type:"text",name:"mail_default_sender",value:a.mail_default_sender,onChange:t,placeholder:"MAU MART <noreply@maumart.com>",className:"input"})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"mail_use_tls",checked:a.mail_use_tls,onChange:t,className:"w-4 h-4 rounded text-primary-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Use TLS"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"mail_use_ssl",checked:a.mail_use_ssl,onChange:t,className:"w-4 h-4 rounded text-primary-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Use SSL"})]})]}),e.jsx("button",{type:"submit",disabled:m,className:"btn-primary disabled:opacity-50",children:m?"Saving...":"Save Configuration"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Test Configuration"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"email",value:r,onChange:s=>y(s.target.value),placeholder:"Enter email to test...",className:"input flex-1"}),e.jsx("button",{onClick:v,disabled:d,className:"btn-secondary disabled:opacity-50",children:d?"Sending...":"Send Test"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Save the configuration first, then send a test email to verify it works."})]}),e.jsxs("div",{className:"card bg-blue-50 border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"ðŸ’¡ Gmail Users"}),e.jsx("p",{className:"text-sm text-blue-800 mb-2",children:"For Gmail, use these settings:"}),e.jsxs("ul",{className:"text-sm text-blue-700 list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Server: smtp.gmail.com"}),e.jsx("li",{children:"Port: 587 (TLS) or 465 (SSL)"}),e.jsx("li",{children:"Use an App Password (not your regular password)"}),e.jsx("li",{children:"Enable 2FA and generate an App Password in Google Account settings"})]})]})]})}export{k as default};
