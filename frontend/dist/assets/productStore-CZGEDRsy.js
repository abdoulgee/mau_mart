import{i as l,f as i}from"./index-BxsvggaG.js";const f=l((e,p)=>({products:[],featuredProducts:[],recentProducts:[],categoryProducts:[],searchResults:[],currentProduct:null,pagination:{page:1,limit:20,total:0,hasMore:!0},isLoading:!1,isLoadingMore:!1,error:null,fetchFeaturedProducts:async()=>{try{const a=await i.get("/api/v1/products/featured");return e({featuredProducts:a.data.products||[]}),a.data.products}catch(a){return console.error("Failed to fetch featured products:",a),[]}},fetchRecentProducts:async(a=10)=>{try{const r=await i.get(`/api/v1/products/recent?limit=${a}`);return e({recentProducts:r.data.products||[]}),r.data.products}catch(r){return console.error("Failed to fetch recent products:",r),[]}},fetchCategoryProducts:async(a,r=1,o={})=>{const s=r===1;e({isLoading:s,isLoadingMore:!s,error:null});try{const t=new URLSearchParams({page:r,limit:20,...o}),c=await i.get(`/api/v1/categories/${a}/products?${t}`),{products:n,pagination:d}=c.data;return e(u=>({categoryProducts:s?n:[...u.categoryProducts,...n],pagination:{...d,hasMore:n.length===20},isLoading:!1,isLoadingMore:!1})),n}catch(t){return e({error:t.message,isLoading:!1,isLoadingMore:!1}),[]}},searchProducts:async(a,r=1)=>{if(!a.trim())return e({searchResults:[]}),[];const o=r===1;e({isLoading:o,isLoadingMore:!o,error:null});try{const s=await i.get(`/api/v1/products/search?q=${encodeURIComponent(a)}&page=${r}`),{products:t,pagination:c}=s.data;return e(n=>({searchResults:o?t:[...n.searchResults,...t],pagination:{...c,hasMore:t.length===20},isLoading:!1,isLoadingMore:!1})),t}catch(s){return e({error:s.message,isLoading:!1,isLoadingMore:!1}),[]}},fetchProduct:async a=>{e({isLoading:!0,error:null,currentProduct:null});try{const r=await i.get(`/api/v1/products/${a}`);return e({currentProduct:r.data.product,isLoading:!1}),r.data.product}catch(r){return e({error:r.message,isLoading:!1}),null}},createProduct:async a=>{var r,o;e({isLoading:!0,error:null});try{const s=new FormData;Object.keys(a).forEach(c=>{c==="media"?a.media.forEach(n=>{s.append("media",n)}):s.append(c,a[c])});const t=await i.post("/api/v1/products",s,{headers:{"Content-Type":"multipart/form-data"}});return e({isLoading:!1}),{success:!0,product:t.data.product}}catch(s){const t=((o=(r=s.response)==null?void 0:r.data)==null?void 0:o.message)||"Failed to create product";return e({error:t,isLoading:!1}),{success:!1,error:t}}},updateProduct:async(a,r)=>{var o,s;e({isLoading:!0,error:null});try{const t=new FormData;Object.keys(r).forEach(n=>{n==="media"&&Array.isArray(r.media)?r.media.forEach(d=>{d instanceof File&&t.append("media",d)}):n==="existing_media"?t.append("existing_media",JSON.stringify(r.existing_media)):t.append(n,r[n])});const c=await i.put(`/api/v1/products/${a}`,t,{headers:{"Content-Type":"multipart/form-data"}});return e({isLoading:!1,currentProduct:c.data.product}),{success:!0,product:c.data.product}}catch(t){const c=((s=(o=t.response)==null?void 0:o.data)==null?void 0:s.message)||"Failed to update product";return e({error:c,isLoading:!1}),{success:!1,error:c}}},deleteProduct:async a=>{try{return await i.delete(`/api/v1/products/${a}`),e(r=>({products:r.products.filter(o=>o.id!==a)})),{success:!0}}catch(r){return{success:!1,error:r.message}}},clearCategoryProducts:()=>e({categoryProducts:[],pagination:{page:1,limit:20,total:0,hasMore:!0}}),clearSearchResults:()=>e({searchResults:[]}),clearCurrentProduct:()=>e({currentProduct:null}),clearError:()=>e({error:null})}));export{f as u};
