import{r as f,b as k,c as A,d as S,e as M,j as e,L as w,f as l}from"./index-BxsvggaG.js";function D(){var u,h;const[a,b]=f.useState({email:"",password:""}),[n,v]=f.useState(!1),{login:y,isLoading:c,error:r,clearError:N}=k(),d=A(),i=S(),L=((h=(u=M().state)==null?void 0:u.from)==null?void 0:h.pathname)||"/",m=o=>{N(),b({...a,[o.target.name]:o.target.value})},T=async o=>{var x,p,g,j;o.preventDefault();const s=await y(a);if(s.success){d.success("Welcome back!");const t=k.getState();console.log("Login successful! State:",{hasAccessToken:!!t.accessToken,accessTokenPreview:((x=t.accessToken)==null?void 0:x.substring(0,30))+"...",hasRefreshToken:!!t.refreshToken,isAuthenticated:t.isAuthenticated,userRole:(p=s.user)==null?void 0:p.role}),t.accessToken?(l.setAuthToken(t.accessToken),console.log("Token set in API client:",((g=l.authToken)==null?void 0:g.substring(0,30))+"...")):console.error("No access token available after login!"),await new Promise(C=>setTimeout(C,100)),console.log("After delay - API token:",((j=l.authToken)==null?void 0:j.substring(0,30))+"..."),s.user.role==="admin"||s.user.role==="super_admin"?(console.log("Navigating to admin dashboard..."),i("/admin/dashboard")):s.user.is_seller?i("/seller"):i(L)}else d.error(s.error)};return e.jsxs("div",{className:"min-h-screen flex flex-col justify-center py-12",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-primary-500 to-primary-600 rounded-2xl shadow-lg shadow-primary-500/30 mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Sign in to continue to MAU MART"})]}),e.jsx("div",{className:"card p-6 mx-auto w-full max-w-sm",children:e.jsxs("form",{onSubmit:T,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"label",children:"Email or Student ID"}),e.jsx("input",{type:"text",id:"email",name:"email",value:a.email,onChange:m,placeholder:"Enter your email or student ID",className:`input ${r?"input-error":""}`,required:!0,autoComplete:"email"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx("label",{htmlFor:"password",className:"label mb-0",children:"Password"}),e.jsx(w,{to:"/forgot-password",className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Forgot password?"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:n?"text":"password",id:"password",name:"password",value:a.password,onChange:m,placeholder:"Enter your password",className:`input pr-12 ${r?"input-error":""}`,required:!0,autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>v(!n),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600",children:n?e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):e.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),r&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-100 rounded-xl",children:e.jsx("p",{className:"text-sm text-red-600",children:r})}),e.jsx("button",{type:"submit",disabled:c,className:"btn-primary w-full py-3.5",children:c?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign In"})]})}),e.jsxs("p",{className:"text-center mt-6 text-gray-600",children:["Don't have an account?"," ",e.jsx(w,{to:"/signup",className:"text-primary-600 hover:text-primary-700 font-medium",children:"Create one"})]})]})}export{D as default};
